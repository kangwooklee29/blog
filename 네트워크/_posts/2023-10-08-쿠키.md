---
title: HTTP 쿠키
---


### 1. 개요

\- 1994년 당시 미국의 통신사 MCI는 온라인 쇼핑 웹서비스를 개발하고 있었고, 그 중에서는 쇼핑 카트 기능이 있었다. 당시 MCI는 클라이언트가 서버에 접속했을 때 각 클라이언트에 관한 정보를 서버쪽이 아니라 클라이언트에 저장하는 걸 바랐기 때문에, 당시 웹 브라우저를 개발하고 있었던 넷스케이프 측에 이 요청을 전달했다. 원래 HTTP는 stateless하게 구현돼있기 때문에 이러한 기능을 구현할 수 없었다. 이에 넷스케이프는 첫 베타버전에서부터 '쿠키'라는 개념을 도입하여 이를 구현했다. 이 '쿠키'라는 이름은, 당시 이미 유닉스에서 프로그램 간 통신 시 전송되던 패킷을 지칭하는 용어로 널리 사용되던 'magic cookie'라는 용어에서 따온 것이다. 

\- stateless한 HTTP의 특성은 웹서버의 구현이라는 측면에서는 편리하나 웹 서비스 운영사 측 입장에서는 여러 방문자에게 개인화 서비스를 제공할 수 없어 일종의 한계점인데, 쿠키의 도입으로 이의 극복이 가능해졌다. 따라서 웹을 통한 영업이 사실상 필수가 된 최근에 들어서 쿠키는 대다수 웹사이트에서 거의 반드시 사용하는 기술이 되었다. 이러한 웹사이트에서는 클라이언트로부터 첫 웹페이지 요청을 받게 되면 그 첫 HTTP 응답 메시지의 헤더에 `Set-Cookie`라는 필드를 포함시켜 쿠키를 발급한다. 이때 이 필드를 통해 쿠키를 수신한 클라이언트의 브라우저는 이를 클라이언트의 PC에 파일 형태로 저장했다가, 이후 그 웹페이지에서 추가로 HTTP 응답 요청 메시지를 전송할 때 해당 쿠키 내용을 그 헤더의 `Cookie` 필드에 담아 전송한다. 이렇게 되면 서버는 서버에 접속한 각 클라이언트를 식별할 수 있으며, 이를 통해 서버에서 stateless한 HTTP에도 불구하고 stateful한 통신을 할 수 있다.

\- 서버로부터 발급받은 쿠키에는 보통 만료 날짜가 있어, 쿠키는 설정된 만료 날짜에 도달하면 자동으로 삭제된다. 사용자가 웹 브라우저의 설정을 통해 수동으로 쿠키를 삭제하거나 모든 쿠키를 일괄 삭제하는 것도 가능하다. 또한, 클라이언트로부터 쿠키와 함께 HTTP 메시지를 수신한 서버가 클라이언트의 쿠키를 강제로 만료시키는 쿠키를 보내는 경우도 있다.


### 2. 쿠키의 형식

```
Set-Cookie: username=JohnDoe
Set-Cookie: sessionId=abc123xyz; Path=/; Secure
Set-Cookie: language=en; Path=/; Expires=Wed, 09 Jun 2024 10:18:14 GMT
...
```

\- 하나의 쿠키는 `Set-Cookie` 필드 하나에 담긴 메시지 내용으로 그 내용이 정해진다. `;`를 기준으로 쿠키의 내용이 구분되는데, 맨 앞에 오는 식의 `=` 앞부분은 그 쿠키의 이름이고 그 뒷부분은 그 쿠키가 갖는 값을 뜻한다.

  - `Path`: 그 쿠키가 유효한 그 도메인 내 경로 범위를 나타낸다. 생략 가능하나, 이 경우 쿠키는 현재 문서의 경로를 기본값으로 사용한다. 즉, 그 경로 및 그 하위 경로에서만 그 쿠키가 유효하게 된다.

  - `Expires`: 그 쿠키의 만료 기간을 뜻한다. 이 속성을 지정하지 않은 쿠키를 '세션 쿠키'라 하며, 세션이 종료될 때, 즉 사용자의 웹 브라우저 창이나 탭이 닫힐 때 소멸한다(일부 브라우저의 경우 완전히 종료하기 전까지 세션이 유지될 수 있다). 반대로 세션 종료 시가 아니라 지정된 만료 기간까지 소멸하지 않는 쿠키를 '영구 쿠키'라 한다.

  - `Secure`: HTTPS로 접소한 경우에만 그 쿠키를 전송하도록 하는 플래그.

\- RFC 6265 표준에 따르면, 브라우저는 한 도메인당 총 50개, 모든 도메인에 대해 최소 300개의 쿠키를 저장할 수 있어야 한다. 쿠키 하나의 최대 크기는 4096 바이트(약 4KB)로 제한된다. 다만 브라우저가 항상 이 표준을 따르리라 기대하는 것은 부적절하며 너무 많은 쿠키를 사용하는 것은 서버-클라이언트 사이 통신 성능에도 악영향이 있다. 따라서 되도록 다른 클라이언트 측 저장 메커니즘(localStorage 등)을 고려할 필요가 있다.

