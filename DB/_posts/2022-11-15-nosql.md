---
title: NoSQL
---


### 1. 개요

\- 데이터베이스 분야에서는 데이터를 잘 짜여진 스키마에 적절히 담아 동시에 여러 트랜잭션이 실행되더라도 서로간 간섭이 없고 데이터베이스의 일관성이 적절히 유지되도록 하는 것이 오랫동안 중요한 과제였으며, 이에 따라 적절히 관리된 데이터베이스 체계는 SQL으로 작성된 쿼리로 여러 데이터를 읽고 쓰기 편리한 점이 있었다. 그러나 2010년대에 접어들어 미리 구조를 알 수 없는 방대한 양의 데이터를 빠른 시간 내에 처리해야 할 요구가 과거보다 훨씬 더 크게 증가했는데, 구조가 불규칙한 방대한 양의 데이터를 잘 처리하기 위해 과거처럼 사전에 스키마를 적절히 구성하는 것은 불가능하며 또 이러한 스키마에 적절히 담기 위해 데이터베이스에 넣기 전 데이터를 정리하는 작업을 수행하는 것은 다소 비효율적일 수 있다. 따라서 최근에는 SQL을 사용할 수 없더라도 스키마를 과거 OLTP 또는 OLAP DB처럼 적절히 구성하기보다는 보다 자유로운 형식으로 두고 데이터 또한 엄격히 형식에 맞춰 정리하지 않는 여러 형태의 데이터베이스 모델이 제시되고 있다. 이처럼 SQL 사용 여부에 구애받지 않는 보다 다양한 형식의 최근의 데이터베이스 모델들을 NoSQL DB(not only SQL database)라 한다.


### 2. CAP 이론

\- 네트워크로 연결된 **분산 DB 시스템**은 일관성(consistency), 가용성(availabilty), 분할 내구성(partition tolerance) **셋을 모두 충족할 수 없다**는 이론을 CAP 이론이라 한다. 따라서 용도에 따라 이 중 두 가지만 충족되더라도 그것이 DB를 선택할 수 있는 중요한 기준이 될 수 있다.

- 일관성: 여러 사용자가 똑같은 시간에 똑같은 데이터를 요청했을 때 모든 사용자에게 똑같은 데이터를 리턴해야 한다는 특성

  - eventual consistency: 어느 순간에 일관성이 준수되지 않을 때가 있더라도 결과적으로 언젠가는 일관성이 준수된다는 개념. 성능 등의 문제로 일관성을 항상 보장하기 어려운 환경에 대해 제시된 개념이다.

- 가용성: 분산 DB 시스템 내 서버 일부에 장애가 발생하더라도 모든 사용자의 읽기/쓰기 요청에 항상 성공적으로 응해야 한다는 특성

- 분할 내구성: 분산 DB 시스템 내 서버 사이에 통신 장애가 발생하더라도 특정 서버에 대한 사용자의 읽기/쓰기 요청은 그 서버와 다른 서버 사이 통신 장애 여부와 무관하게 성공적으로 응해야 한다는 특성



### 3. NoSQL DB의 유형

#### 1) key-value stores

\- 다양한 유형의 데이터(value)를 key값을 통해 접근할 수 있도록 데이터를 저장하는 방식. 하나의 키값은 오직 하나의 아이템에 매핑되나 그 아이템의 데이터형은 어떤 유형이든 가능하다. 테이블로 표현할 경우 컬럼이 2개(하나는 키값, 하나는 그에 대응되는 데이터)인 테이블이라 할 수 있다.

- 장점: 데이터의 값을 얻어오고 삽입/삭제를 수행하는 방식이 빠르고 간단하며 특히 join 연산 같은 연산을 할 필요가 없어 DB의 규모가 급격히 커지는 상황에서도 사용하기 좋다.
  
- 단점: 특정 값에 관한 쿼리를 통해 값을 얻어올 방법이 전혀 없다.

- Memcached: key-value store 방식의 오픈소스 분산형 메모리 캐시 시스템으로, 메인 메모리에 상주해 다른 DB에서 호출한 데이터 내용을 캐시하는 식으로 사용된다. 유튜브, 페이스북, 트위터 등 여러 웹 서비스 업체에서 널리 사용되고 있으며, AWS, Microsoft Azure 등 여러 클라우드 업체에서도 서비스를 제공한다.

- redis: key-value store 방식의 오픈소스 DBMS로, 메인 메모리에 상주하여 싱글 스레드로 동작해 매우 빠른 속도로 데이터를 읽고 쓰는 것을 지원한다. key-value store 방식의 DBMS 중 압도적인 인기를 누리고 있는 DBMS로 여겨진다.


#### 2) column-family

\- 하나의 키값에 여러 개의 컬럼 패밀리를 매핑해, 테이블 내 한 아이템에 접근하려면 행 이름 - 컬럼 패밀리 이름 - 그 컬럼 패밀리에 속하는 컬럼 이름 총 세 개의 키값을 필요로 하는 방식. 서로 연관된 컬럼들을 같은 컬럼 패밀리로 묶어 관리하는데, 이는 각 속성들 사이에 계층 구조가 있는 셈이다. 같은 컬럼 패밀리에 속하는 컬럼끼리는 서로 독립적이며, 따라서 이 DB 모델을 하나의 거대한 테이블에 여러 컬럼이 있고 컬럼들 중 연관된 것들끼리는 같은 컬럼 패밀리 이름이 붙은 모델이라고 생각할 수 있다.

- 장점: **DB의 스케일을 키워나가기 용이하다.** (다른 NoSQL DB 유형 중 특히 분산 컴퓨팅 환경에서 많이 쓰인다.) 키값, 컬럼 패밀리 이름, 컬럼 이름에 관한 **쿼리를 처리할 수 있다.** (다만 테이블 내 데이터값은 blob이 들어갈 수 있어 쿼리 처리가 불가하다.)

- 단점: 처음에 결정된 키값, 컬럼을 잘못 설정했더라도 이를 변경할 수 없다.

- Bigtable: column-family 방식의 DB 모델을 처음 제시한 구글의 DB 서비스. 테이블 내 아이템에 접근하는 키값으로 행, 컬럼 패밀리, 컬럼 이름에 더해 추가로 timestamp를 갖는다. 이는 그 행, 컬럼 패밀리, 컬럼의 특정 시간의 값을 기록하기 위한 키값으로, 시간에 따른 DB 내 데이터 값들의 변화를 기록하기 위한 목적이다. 구글의 지메일, 구글맵, 유튜브 같은 수많은 서비스에서 사용되고 있다.

- HBase: Bigtable에서 영향을 받은 아파치의 Hadoop 플랫폼을 위한 오픈소스 분산형 DB. 한 행은 수만 개의 컬럼을 갖는데, 그 중 값이 있는 컬럼은 많지 않다. 이처럼 한 행에 수만 개의 컬럼이 매핑되도록 한 것은 Bigtable과 유사하게 하나의 행에 여러 유형의 데이터를 둘 수 있게, 한 행에 매핑되는 데이터의 수가 늘어나도 이에 유연하게 대처할 수 있게 한 것이다. Bigtable보다 각 컬럼 사이 계층화를 더 세분한다. (컬럼 패밀리들을 다시 여러 super-column의 하위 컬럼 패밀리로 분류하는 식.) 다양한 Hadoop 도구들과 함께 쓰기 좋다.

- Cassandra: 아파치의 오픈소스 분산형 DBMS. (서버 대수가 늘어난다고 해서 꼭 성능이 그에 비례해서 증가하지는 않았던 다른 분산형 DBMS와 달리) 서버 대수가 늘어나는 만큼 그에 비례해 성능도 증가하는 것으로 인지도가 높다. 


#### 3) graph store

\- 데이터를 노드 그리고 노드 사이 연결관계로 저장하는 방식. 쿼리를 실행시키면 그래프를 순회하여 데이터를 가져온다. 

- 장점: 네트워크를 순회하여 데이터를 가져오는 데 특화돼있어 데이터 사이 연결관계가 중요한 데이터셋을 관리하기 좋다.

- 단점: 그래프의 크기가 방대할 경우 이를 처리하기 어렵고, 특수한 쿼리 언어를 사용해야 한다. 

- Neo4j: 그래프를 다루는 대표적인 데이터베이스. 트랜잭션의 네 특성(ACID)을 지원한다.



#### 4) document store

\- 계층적 구조를 갖는 데이터가 있을 때, RDB 모델처럼 이를 일정한 형태의 스키마로 재구성(shredding)해 저장하는 게 아니라 **원래의 계층적 구조 그대로 저장**하는 방식. 대개 XML 또는 JSON 포맷으로 저장하며, XQuery 같이 document store에 특화된 쿼리 언어를 지원한다. 출판사 등 다양한 형식의 데이터를 다뤄야 하는 분야에서 널리 쓰인다.

- 장점: 데이터를 재구성하는 overhead가 없다. (특히 웹서비스는 서버가 DB에서 데이터를 가져와 이를 HTML 형식 문서로 변환하는 과정이 필수적인데 RDB 모델을 사용할 경우 이 overhead가 반드시 있고, 여기서 문제가 발생하는 경우가 많다.) DB를 구축할 때 스키마에 관한 사전정보를 알 필요가 없다. (다만 데이터를 입력받을 때마다 메타데이터로서 인덱스를 생성하는 절차가 있다.) DB에서 데이터를 찾아 읽어오는 속도가 충분히 빠르다. 

- 단점: SQL의 여러 강력한 기능들을 활용할 수 없다.

- MarkLogic: MarkLogic사에서 페타바이트 단위 데이터를 다루기 위해 만든 XML 기반 데이터베이스. 트랜잭션의 네 특성(ACID)을 지원한다. 가장 성공한 NoSQL 회사 중 하나로 꼽힌다.

- mongoDB: JSON 기반 오픈소스 데이터베이스. 가장 유명한 NoSQL DB 중 하나로, 구글, 페이스북 같은 대기업에서도 사용한다. 