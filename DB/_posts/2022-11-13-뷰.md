### 1. 개요

\- RDB에서 뷰(view)는 일종의 가상의 릴레이션으로, 실제 릴레이션(=기본 릴레이션, base relation)을 기초로 그것에 여러 조건문을 추가하거나 다른 릴레이션, 뷰와 join을 해서 만들어낸 derived relation이다. '기본 릴레이션/뷰에 대하여 selection/projection 연산을 한 것'으로 정의되며, 따라서 기본 릴레이션의 어느 한 값이 변경될 때 그에 대한 뷰 역시 함께 변화한다. 따라서 뷰를 사용하면 자주 사용하는 복잡한 쿼리를 간결한 표현으로 사용할 수 있다는 점, 보안상 이점, 데이터 무결성 등 여러 이점이 있다. 

- 기본적으로 RDB의 뷰는 ANSI/SPARC의 뷰와는 다른 개념이지만, ANSI/SPARC의 뷰의 이점인 데이터 독립성(외부 단계 스키마의 변경 없이 내부 단계 스키마의 수정이 가능) 같은 이점을 누릴 수 있다는 점도 RDB의 뷰의 이점이다.

- 사용자들이 기본 릴레이션에 직접 접근하는 것을 차단하되 그에 대한 여러 형태의 뷰를 생성하고 이들에 대해 접근하는 것은 허용함으로써, 기본 릴레이션 접근권을 허용하지 않으면서 사용자들이 데이터베이스를 필요한 만큼 충분히 사용할 수 있게 하는 보안상 이점을 누릴 수 있다.

\* 스냅샷(snapshot): 특정 어느 한 시점의 릴레이션에서 SELECT 쿼리로 일부 레코드, 필드를 추출해 사진 찍은 듯 저장해놓은 것. 시점 변화와 함께 기본 릴레이션의 값이 달라지면 마찬가지로 값이 달라지는 뷰와는 다른 개념이다.


### 2. SQL로 뷰 정의하기

```sql
CREATE VIEW view1(field1, field2) AS SELECT field1, field2*2 FROM table1 WHERE field1 > 0 WITH CHECK OPTION
```

\- `CREATE VIEW` 구문 바로 뒤에는 새로 정의할 뷰의 이름과 기본 릴레이션에서 뷰에 넣을 속성의 이름을 쓰는데, 속성의 이름은 생략할 수 있으며 이 경우 기본 릴레이션 위치에 들어가는 `SELECT` 쿼리의 모든 속성이 새 뷰에 포함된다. 단, 기본 릴레이션 위치에 들어가는 `SELECT` 쿼리의 각 속성 위치에 그룹함수 또는 수식이 있거나 join 연산의 결과라서 이름이 똑같은 속성이 있는 경우에는 새 이름을 지정해야 한다.

\- 뷰를 정의할 때 `WITH CHECK OPTION` 구문을 추가하면 그 뷰에 대하여 `UPDATE` 또는 `INSERT` 쿼리를 그 뷰의 정의에 어긋나게 사용했을 때(변경사항이 뷰의 정의에 포함되지 않게 쿼리를 썼을 때) 그 쿼리를 무시하게 할 수 있다. 이를 이용해, 기본 릴레이션에 여러 조건식을 걸어 뷰를 정의하고 데이터의 삽입/수정/삭제를 뷰만을 통해 함으로써 뷰를 데이터 무결성을 보장하는 수단으로 쓸 수 있다.


### 3. 실제 릴레이션처럼 뷰 사용하기

```sql
SELECT field1 FROM view1
```

- 실제 릴레이션과 같은 방식으로 뷰에 대해 `SELECT` 쿼리를 사용할 수 있다. DBMS에서 이 경우 이 쿼리에 명시된 뷰의 기본 릴레이션으로부터 뷰를 추출한 다음 그에 대한 쿼리 수행의 결과를 얻어올 수도 있지만, 그렇게 처리하면 쿼리를 두 번 수행하게 되어 overhead가 커질 수 있다. 이외에 뷰에 대한 쿼리를 그 뷰의 기본 릴레이션에 관한 쿼리로 해석하여 처리하는 방법도 있다.

```sql
UPDATE view1 SET field1=0 WHERE field1 > 0
INSERT INTO view1 VALUES(0)
```

- 실제 릴레이션과 같은 방식으로 뷰에 대해 `UPDATE` 또는 `INSERT` 쿼리를 사용할 수 있다. 단, 다음과 같은 문제가 있는 쿼리라면 DBMS가 에러를 발생시킨다. 

  - `WITH CHECK OPTION` 구문과 함께 정의된 뷰에 대하여 그 쿼리를 그 뷰의 정의에 어긋나게 사용한(변경사항이 뷰의 정의에 포함되지 않게 쿼리를 쓴) 쿼리

  - 기본 릴레이션의 무결성 제약조건을 위반한 쿼리. primary key 또는 스키마에 NOT NULL 제약조건이 지정된 속성의 값을 null로 한 튜플을 추가하는 `INSERT` 쿼리 등. 

  - 기본 릴레이션이 **join 연산**으로 정의된 뷰. 이론상으로는 DBMS로 충분히 구현할 수 있으나, 실제 DBMS가 이러한 기능을 지원하도록 하는 것은 구현 난이도, 실효성 등의 문제가 있어서 현실적으로 지원되는 사례가 없다. 

  - 기본 릴레이션에 대해 **그룹 함수**를 사용해 정의된 뷰

